generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}

model User {
  id          String     @id @default(uuid())
  email       String     @unique
  password    String
  companyName String?
  ico         String?
  dic         String?
  address     String?
  phone       String?
  bankAccount String?
  isVatPayer  Boolean    @default(false)
  deletedAt   DateTime?
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
  invoices    Invoice[]
}

model Customer {
  id        String    @id @default(uuid())
  name      String
  email     String?
  phone     String?
  address   String?
  ico       String?
  dic       String?
  invoices  Invoice[]
  createdAt DateTime  @default(now())
  updatedAt DateTime  @updatedAt
}

model Invoice {
  id             String        @id @default(uuid())
  number         Int
  issueDate      DateTime
  dueDate        DateTime
  taxableDate    DateTime
  variableSymbol String?
  constantSymbol String?
  specificSymbol String?
  note           String?
  total          Float
  currency       String        @default("CZK")
  language       String        @default("cs")
  isVatReverseCharge Boolean   @default(false)
  qrCodeString   String?
  qrCodeDataUrl  String?
  status         String        @default("DRAFT")
  isPaid         Boolean       @default(false)
  userId         String
  user           User          @relation(fields: [userId], references: [id])
  customerId     String
  customer       Customer      @relation(fields: [customerId], references: [id])
  items          InvoiceItem[]
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
}

model InvoiceItem {
  id          String  @id @default(uuid())
  description String
  quantity    Float
  unitPrice   Float
  vatRate     Float   @default(0)
  unit        String?
  invoiceId   String
  invoice     Invoice @relation(fields: [invoiceId], references: [id], onDelete: Cascade)
}
